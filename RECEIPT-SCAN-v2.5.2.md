# 📸 סריקת קבלות להוצאות - גרסה 2.5.2
## תאריך: 07/12/2024

---

## 🎉 תכונה חדשה: צרף קבלה להוצאה!

### מה נוסף?

**בלשונית "הוצאות"** - עכשיו אפשר לצרף קבלה (תמונה/PDF) לכל הוצאה!

---

## 🎯 איך זה עובד?

### הוספת הוצאה עם קבלה:

```
1. לך ללשונית "הוצאות"
2. לחץ "הוסף הוצאה חדשה"
3. מלא את הפרטים (תאריך, קטגוריה, תיאור, סכום...)
4. *** חדש! *** סעיף "צרף קבלה/תמונה":
   
   א. במחשב: לחץ "בחר קובץ" → העלה תמונה/PDF
   ב. במובייל: לחץ "צלם קבלה" 📷 → צלם את הקבלה
   
5. תראה תצוגה מקדימה של הקבלה
6. לחץ "שמור"
7. ✅ ההוצאה נשמרה עם הקבלה!
```

### צפייה בקבלה:

```
1. לך ללשונית "הוצאות"
2. ראה את הטבלה
3. בעמודה "קבלה" - אם יש קבלה תראה כפתור ירוק 📷
4. לחץ על הכפתור
5. → הקבלה נפתחת בחלון גדול
6. תוכל להוריד את הקבלה או לסגור
```

---

## 📊 התכונות החדשות

### 1️⃣ העלאת קבלה מהמחשב
- **כפתור "בחר קובץ"**
- תומך ב: JPG, PNG, PDF
- גודל מקסימלי: 5MB
- תצוגה מקדימה מיידית

### 2️⃣ צילום קבלה במובייל
- **כפתור "צלם קבלה" 📷**
- פותח את המצלמה במובייל
- צילום ישיר של הקבלה
- שמירה אוטומטית

### 3️⃣ תצוגה מקדימה
- רואים את הקבלה לפני השמירה
- אפשרות להסיר ולהעלות מחדש

### 4️⃣ כפתור בטבלה
- **כפתור ירוק 📷** בעמודה "קבלה"
- לחיצה → צפייה מלאה
- אפשרות הורדה

### 5️⃣ שמירה ב-LocalStorage
- הקבלה נשמרת כ-Base64
- לא צריך שרת!
- הכל מקומי ובטוח

---

## 🎨 העיצוב

### טבלת הוצאות:
```
┌────────┬─────────┬──────┬──────┬─────────┬──────┬────────┬─────────┐
│ תאריך  │ קטגוריה│ תיאור│ סכום │ שולם ע"י│ קבלה │ הערות  │ פעולות │
├────────┼─────────┼──────┼──────┼─────────┼──────┼────────┼─────────┤
│01/12/24│ חשמל    │חשבון│ 500₪│  משה    │ [📷] │ תשלום │ [✏️][🗑️]│
│        │         │      │      │         │  ↑   │        │         │
│        │         │      │      │         │ ירוק!│        │         │
└────────┴─────────┴──────┴──────┴─────────┴──────┴────────┴─────────┘
```

### טופס הוצאה:
```
┌──────────────────────────────────────┐
│ הוסף הוצאה חדשה                      │
├──────────────────────────────────────┤
│ תאריך: [______]  קטגוריה: [____]   │
│ תיאור: [_____________________]      │
│ סכום: [____]  שולם ע"י: [_____]    │
│ הערות: [_____________________]      │
│                                      │
│ 📷 צרף קבלה/תמונה:                 │
│ [בחר קובץ] [צלם קבלה 📷]           │
│ קובץ: [תמונה.jpg]                   │
│                                      │
│ [תצוגה מקדימה]                      │
│ [הסר קבלה]                          │
│                                      │
│ [שמור] [ביטול]                      │
└──────────────────────────────────────┘
```

---

## 💡 תרחישי שימוש

### תרחיש 1: תשלום חשמל
```
1. קיבלת חשבון חשמל
2. פותח "הוצאות" → "הוסף הוצאה"
3. ממלא: קטגוריה=חשמל, סכום=500₪
4. במובייל → "צלם קבלה" → צולם את החשבון
5. שומר
6. ✅ ההוצאה שמורה עם תמונת החשבון!
```

### תרחיש 2: בדיקת קבלות
```
1. לשונית "הוצאות"
2. רואה את כל ההוצאות
3. ליד הוצאת חשמל → כפתור ירוק 📷
4. לוחץ
5. → רואה את חשבון החשמל במסך מלא
6. לוחץ "הורד" → מוריד את הקבלה
```

### תרחיש 3: עריכת הוצאה
```
1. לחיצה על "ערוך" ליד הוצאה
2. → הטופס נפתח עם כל הפרטים
3. → הקבלה הקיימת מוצגת בתצוגה מקדימה
4. אפשר:
   - להשאיר את הקבלה כמו שהיא
   - להסיר ולהעלות קבלה חדשה
   - להוסיף קבלה אם לא היתה
```

---

## 🔧 שינויים טכניים

### קובץ: `index.html`

#### טבלה:
```html
<thead>
    <tr>
        ...
        <th>קבלה</th>  <!-- עמודה חדשה! -->
        ...
    </tr>
</thead>
```

#### טופס:
```html
<div class="form-group">
    <label>📷 צרף קבלה/תמונה</label>
    <input type="file" id="expenseReceiptFile" accept="image/*,application/pdf">
    <button onclick="document.getElementById('expenseReceiptFile').click()">
        בחר קובץ
    </button>
    <button onclick="captureReceiptPhoto()">
        📷 צלם קבלה
    </button>
    <div id="receiptPreview">
        <img id="receiptPreviewImg">
    </div>
</div>
```

### קובץ: `js/app.js`

#### פונקציות חדשות:

1. **`captureReceiptPhoto()`** - פותח מצלמה במובייל
2. **`handleReceiptFile(file)`** - מעבד קובץ שהועלה
3. **`removeReceipt()`** - מסיר קבלה
4. **`viewExpenseReceipt(id)`** - מציג קבלה במסך מלא
5. **`downloadExpenseReceipt(id)`** - מוריד קבלה

#### עדכונים לפונקציות קיימות:

- **`saveExpense()`** - שומר גם את `receiptImage`
- **`editExpense()`** - טוען את הקבלה הקיימת
- **`addExpense()`** - מנקה קבלה קודמת
- **`renderExpensesTable()`** - מציג כפתור 📷 אם יש קבלה

---

## ✅ מה נשמר?

### הכל! 💯
- ✅ כל הפונקציות של הוצאות
- ✅ קטגוריות קיימות
- ✅ חישובים וסיכומים
- ✅ סינון וחיפוש
- ✅ **+ סריקת קבלות!** 🆕

---

## 🔒 אבטחה ופרטיות

### איפה הקבלות נשמרות?
- **LocalStorage** בדפדפן שלך
- **לא נשלח לשרת!**
- **רק אצלך במכשיר**

### גודל וסוג קבצים:
- תמונות: JPG, PNG, WEBP
- מסמכים: PDF
- גודל מקסימלי: **5MB**

### המרה ל-Base64:
```javascript
const reader = new FileReader();
reader.onload = function(e) {
    currentReceiptImage = e.target.result; // Base64 string
};
reader.readAsDataURL(file);
```

---

## 📊 השוואה: לפני ואחרי

| פעולה | לפני | אחרי |
|-------|------|------|
| **רישום הוצאה** | רק פרטים | פרטים + קבלה! |
| **אימות הוצאה** | חיפוש בניירות 😰 | לחיצה על 📷 ✅ |
| **ארכיון** | קופסת קבלות 📦 | דיגיטלי 💾 |
| **גיבוי** | אין | אוטומטי |
| **חיפוש** | ידני | מיידי |

---

## 🎁 יתרונות

### 1. 📱 נוחות
- צילום במקום
- אין צורך בסורק
- הכל במובייל

### 2. 🗄️ ארגון
- כל הקבלות במקום אחד
- קשורות להוצאה
- קל למצוא

### 3. 💾 גיבוי אוטומטי
- נשמר ב-LocalStorage
- לא נאבד
- תמיד זמין

### 4. 🔍 חיפוש מהיר
- לא צריך לחפש בקופסה
- לחיצה אחת
- צפייה מיידית

### 5. ✉️ שיתוף קל
- הורדה בקליק
- שליחה במייל
- שמירה בענן (אם רוצה)

---

## 🔒 קבצי גיבוי

נוצרו קבצי גיבוי:
- ✅ `index.html.backup-v2.5.1-before-receipts`
- ✅ `js/app.js.backup-v2.5.1-before-receipts`

---

## 🎉 סיכום

**גרסה 2.5.2 מביאה:**
- ✅ סריקת קבלות (תמונה/PDF)
- ✅ צילום ישיר במובייל 📷
- ✅ תצוגה מקדימה
- ✅ כפתור בטבלה לצפייה
- ✅ הורדה והדפסה
- ✅ שמירה מקומית ובטוחה

**המערכת מוכנה לשימוש!** 🚀

---

**גרסה:** 2.5.2  
**תאריך:** 07/12/2024  
**מפתח:** בועז סעדה

**🎉 תהנה מהתכונה החדשה! 🎉**
