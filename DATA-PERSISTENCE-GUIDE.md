# 📱 מדריך שמירת נתונים - PWA

## ❓ שאלה נפוצה: "הנתונים שלי נעלמים אחרי התקנה!"

### ✅ **תשובה: הנתונים לא אמורים להעלם!**

מגרסה 2.4.3 ואילך, המערכת **מגבה ושומרת את הנתונים אוטומטית** לפני ואחרי התקנה.

---

## 🔍 איך זה עובד?

### **1. לפני ההתקנה**
כשאתה לוחץ על **"התקן למסך הבית"**:
- ✅ המערכת יוצרת **גיבוי אוטומטי** של כל הנתונים
- ✅ הגיבוי נשמר ב-**מספר מפתחות** ב-LocalStorage
- ✅ הקונסולה תראה: `✅ גיבוי נתונים בוצע לפני התקנה`

### **2. אחרי ההתקנה**
כשהאפליקציה נפתחת לראשונה:
- ✅ המערכת **מחפשת גיבוי** אוטומטית
- ✅ אם נמצא גיבוי, היא **משחזרת את הנתונים**
- ✅ הקונסולה תראה: `✅ נתונים שוחזרו מגיבוי`

### **3. שימוש רגיל**
- ✅ כל שינוי **נשמר מיד** ב-LocalStorage
- ✅ הקונסולה תראה: `💾 נתונים נשמרו: X דיירים, Y תשלומים`
- ✅ הנתונים נשארים גם אם סוגרים את האפליקציה

---

## 🛠️ איך לוודא שהנתונים נשמרים?

### **בדיקה בקונסולה**
1. פתח את האפליקציה
2. לחץ `F12` (Developer Tools)
3. לך לטאב **"Console"**
4. חפש הודעות:
   - `📥 טוען נתונים מ-LocalStorage...`
   - `✅ נטענו: X דיירים, Y תשלומים`
   - `💾 נתונים נשמרו: X דיירים, Y תשלומים`

### **בדיקת LocalStorage ידנית**
1. פתח Developer Tools (`F12`)
2. לך לטאב **"Application"** (Chrome) או **"Storage"** (Firefox)
3. פתח **"Local Storage"** בצד שמאל
4. בחר את ה-domain שלך
5. חפש מפתחות:
   - `tenantManagementData` - הנתונים הראשיים
   - `tenantManagementSettings` - ההגדרות
   - `tenantManagement_BACKUP` - גיבוי אוטומטי

---

## 🚨 אם הנתונים בכל זאת נעלמו

### **שלב 1: בדוק גיבוי אוטומטי**
פתח קונסולה והרץ:
```javascript
const backup = localStorage.getItem('tenantManagement_BACKUP');
if (backup) {
    const data = JSON.parse(backup);
    console.log('נמצא גיבוי!', data);
    // שחזר את הנתונים
    localStorage.setItem('tenantManagementData', data.data);
    localStorage.setItem('tenantManagementSettings', data.settings);
    location.reload();
}
```

### **שלב 2: שחזר מקובץ גיבוי**
אם יש לך קובץ גיבוי שהורדת:
1. לך ל**"הגדרות"** → **"ניהול נתונים"**
2. לחץ **"העלה גיבוי"**
3. בחר את קובץ ה-JSON
4. הנתונים יוחזרו!

### **שלב 3: צור גיבוי קבוע**
מומלץ **להוריד גיבוי** מדי פעם:
- לחץ על הכפתור **"גיבוי מהיר"** ירוק בטאב "דיירים"
- או לחץ על הכפתור **"גיבוי"** בסרגל העליון
- הקובץ יורד לתיקיית Downloads
- שמור אותו במקום בטוח!

---

## 💡 טיפים לשמירת נתונים

### ✅ **המלצות**
1. **צור גיבוי שבועי** - לחץ על "גיבוי מהיר" פעם בשבוע
2. **שמור בענן** - העלה את הגיבוי ל-Google Drive או Dropbox
3. **בדוק את הקונסולה** - וודא שאתה רואה הודעות שמירה
4. **אל תנקה דפדפן** - ניקוי cache/cookies ימחק את LocalStorage

### ❌ **דברים שלא לעשות**
1. ❌ לא לנקות "Site data" או "Cookies and site data"
2. ❌ לא למחוק את האפליקציה בלי גיבוי
3. ❌ לא לעבור דפדפן בלי לייצא את הנתונים לפני
4. ❌ לא להסתמך רק על הגיבוי האוטומטי - תמיד צור גיבוי ידני!

---

## 📊 איפה הנתונים נשמרים?

### **LocalStorage**
- **מיקום:** בדפדפן במחשב/טלפון שלך
- **גודל:** עד 10MB (מספיק לאלפי דיירים)
- **זמינות:** ללא צורך באינטרנט
- **אבטחה:** מקומי בלבד, לא נשלח לשרת

### **מפתחות LocalStorage**
- `tenantManagementData` - דיירים, תשלומים, הוצאות
- `tenantManagementSettings` - הגדרות, יו"ר, גזבר, חתימה
- `tenantManagement_BACKUP` - גיבוי אוטומטי
- `lastBackupDate` - תאריך גיבוי אחרון

---

## 🔧 טכני: איך זה עובד?

### **JavaScript Events**
```javascript
// לפני התקנה
window.addEventListener('beforeinstallprompt', () => {
    backupDataBeforeInstall(); // גיבוי אוטומטי
});

// אחרי התקנה
window.addEventListener('appinstalled', () => {
    restoreDataAfterInstall(); // שחזור אוטומטי
});

// כשרץ כ-PWA
if (window.matchMedia('(display-mode: standalone)').matches) {
    restoreDataAfterInstall(); // שחזור אם נדרש
}
```

---

## ✅ סיכום

- ✅ **הנתונים נשמרים אוטומטית** ב-LocalStorage
- ✅ **גיבוי אוטומטי** לפני כל התקנה/עדכון
- ✅ **שחזור אוטומטי** אחרי התקנה
- ✅ **הודעות דיבאג** בקונסולה
- ✅ **אפס איבוד נתונים** - מובטח!

**אם יש בעיה, צור קשר עם בועז סעדה.**

---

© 2024 בועז סעדה - All Rights Reserved
